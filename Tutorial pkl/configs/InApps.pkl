amends "../templates/InAppsTemplate.pkl"

import "../templates/InAppsTemplate.pkl"

inapps {
  // --- InApp 1: Modal with image background (sdkVersion min=9, max=null) ---
  new {
    id = "063af404-6800-46a8-8601-1487fb53c4cf"
    isPriority = true
    delayTime = "00:00:01"
    sdkVersion {
      min = 9
      max = null
    }
    frequency {
      kind = "lifetime"
      $type = "once"
    }
    targeting {
      nodes {
        new InAppsTemplate.ApiMethodCallNode {
          internalId = "116"
          systemName = "categoryReco.sync"
        }
        new InAppsTemplate.VisitNode {
          kind = "gte"
          value = 1
        }
        new InAppsTemplate.ViewProductIdNode {
          kind = "substring"
          value = "1"
        }
      }
      $type = "and"
    }
    form {
      variants {
        new InAppsTemplate.ModalVariant {
          content {
            background {
              layers {
                new {
                  action {
                    intentPayload = "приветик"
                    value = "https://dummyimage.com/100x100/ff0/000.png"
                    $type = "redirectUrl"
                  }
                  source {
                    value = "https://mobile-static.mindbox.ru/f3d41714973639a3e18788e4b582f451d0952f723ccd9f33092d841bbb9e5b95/aad15fba0585dbde0e8fc6487728a801120a2515eb8b1bd0a16dd6cae01a5e57.jpg"
                    $type = "url"
                  }
                  $type = "image"
                }
              }
            }
            elements {
              new {
                color = "#FFFFFF"
                lineWidth = 5
                size {
                  kind = "dp"
                  width = 18
                  height = 18
                }
                position {
                  margin {
                    kind = "proportion"
                    top = 0.175
                    right = 0.0535
                    left = 0
                    bottom = 0
                  }
                }
              }
            }
          }
          imageUrl = ""
          redirectUrl = ""
          intentPayload = ""
        }
      }
    }
  }

  // --- InApp 2: SimpleImage (sdkVersion min=9, max=7) ---
  new {
    id = "063af404-6800-46a8-8601-1487fb53c4cf"
    sdkVersion {
      min = 9
      max = 7
    }
    frequency {
      kind = "lifetime"
      $type = "once"
    }
    targeting {
      nodes {
        new InAppsTemplate.ApiMethodCallNode {
          internalId = "116"
          systemName = "categoryReco.sync"
        }
        new InAppsTemplate.VisitNode {
          kind = "gte"
          value = 1
        }
        new InAppsTemplate.ViewProductIdNode {
          kind = "substring"
          value = "1"
        }
      }
      $type = "and"
    }
    form {
      variants {
        new InAppsTemplate.SimpleImageVariant {
          imageUrl = "https://mobile-static.mindbox.ru/f3d41714973639a3e18788e4b582f451d0952f723ccd9f33092d841bbb9e5b95/aad15fba0585dbde0e8fc6487728a801120a2515eb8b1bd0a16dd6cae01a5e57.jpg"
          redirectUrl = "https://dummyimage.com/100x100/ff0/000.png"
          intentPayload = "приветик"
        }
      }
    }
  }

  // --- InApp 3: Modal with webview action (sdkVersion min=11, max=11) ---
  new {
    id = "42647037-c392-4544-9f35-74a2a6033a96"
    isPriority = true
    delayTime = "00:00:10"
    sdkVersion {
      min = 11
      max = 11
    }
    frequency {
      kind = "lifetime"
      $type = "once"
    }
    targeting {
      nodes {
        new InAppsTemplate.VisitNode {
          kind = "gte"
          value = 2
        }
        new InAppsTemplate.SegmentNode {
          kind = "positive"
          segmentationInternalId = "112"
          segmentationExternalId = "e6390922-48c8-4492-8d03-e3c4080a56ad"
          segmentExternalId = "a9ca402f-b6ac-4d57-a181-d37b1d8a7130"
        }
        new InAppsTemplate.ApiMethodCallNode {
          internalId = "26"
          systemName = "Mobile.AddToWishList"
        }
      }
      $type = "and"
    }
    form {
      variants {
        new InAppsTemplate.ModalVariant {
          content {
            background {
              layers {
                new {
                  action {
                    intentPayload = """
                      {\n"baseUrl": "https: //inapp.local/quiz",\n"contentUrl": "https: //api-staging.mindbox.ru/mobile/byendpoint/webview/quiz.html",\n"$type": "webview",\n"params": {\n    "wizardId": "c5bb173f-10a2-47df-a280-a04cf1ca613d"\n    }\n}
                      """
                    value = ""
                    $type = "redirectUrl"
                  }
                  source {
                    value = "https://mobile-static.mindbox.ru/f3d41714973639a3e18788e4b582f451d0952f723ccd9f33092d841bbb9e5b95/48d0217513ae3384382ceb2c2f835902b61acc001c0f130421d07ae69d74a72d.jpg"
                    $type = "url"
                  }
                  $type = "image"
                }
              }
            }
            elements {
              new {
                color = "#000000"
                lineWidth = 1
                size {
                  kind = "dp"
                  width = 24
                  height = 24
                }
                position {
                  margin {
                    kind = "proportion"
                    top = 0.02
                    right = 0.02
                    left = 0
                    bottom = 0
                  }
                }
              }
            }
          }
          imageUrl = ""
          redirectUrl = ""
          intentPayload = ""
        }
      }
    }
  }

  // --- InApp 4: Modal with country targeting, OR logic (sdkVersion min=8, max=null) ---
  new {
    id = "fa46b869-e707-4332-92ea-98dbfaaabb0a"
    isPriority = false
    delayTime = null
    sdkVersion {
      min = 8
      max = null
    }
    frequency {
      kind = "lifetime"
      $type = "once"
    }
    targeting {
      nodes {
        new InAppsTemplate.CountryNode {
          kind = "positive"
          ids {
            2017370
          }
        }
        new InAppsTemplate.SegmentNode {
          kind = "negative"
          segmentationInternalId = "111"
          segmentationExternalId = "f6896804-c865-45eb-9260-bd1b3c27a5b0"
          segmentExternalId = "f6896804-c865-45eb-9260-bd1b3c27a5b0"
        }
      }
      $type = "or"
    }
    form {
      variants {
        new InAppsTemplate.ModalVariant {
          content {
            background {
              layers {
                new {
                  action {
                    intentPayload = "123123123"
                    value = "https://upload.wikimedia.org/wikipedia/commons/thumb/0/0e/Felis_silvestris_silvestris.jpg/1200px-Felis_silvestris_silvestris.jpg"
                    $type = "redirectUrl"
                  }
                  source {
                    value = "https://upload.wikimedia.org/wikipedia/commons/thumb/0/0e/Felis_silvestris_silvestris.jpg/1200px-Felis_silvestris_silvestris.jpg"
                    $type = "url"
                  }
                  $type = "image"
                }
              }
            }
            elements {
              new {
                color = "#000000"
                lineWidth = 1
                size {
                  kind = "dp"
                  width = 24
                  height = 24
                }
                position {
                  margin {
                    kind = "proportion"
                    top = 0.02
                    right = 0.02
                    left = 0
                    bottom = 0
                  }
                }
              }
            }
          }
          imageUrl = ""
          redirectUrl = ""
          intentPayload = ""
        }
      }
    }
  }

  // --- InApp 5: SimpleImage with country targeting, OR logic (sdkVersion min=3, max=7) ---
  new {
    id = "fa46b869-e707-4332-92ea-98dbfaaabb0a"
    sdkVersion {
      min = 3
      max = 7
    }
    frequency {
      kind = "lifetime"
      $type = "once"
    }
    targeting {
      nodes {
        new InAppsTemplate.CountryNode {
          kind = "positive"
          ids {
            2017370
          }
        }
        new InAppsTemplate.SegmentNode {
          kind = "negative"
          segmentationInternalId = "111"
          segmentationExternalId = "f6896804-c865-45eb-9260-bd1b3c27a5b0"
          segmentExternalId = "f6896804-c865-45eb-9260-bd1b3c27a5b0"
        }
      }
      $type = "or"
    }
    form {
      variants {
        new InAppsTemplate.SimpleImageVariant {
          imageUrl = "https://upload.wikimedia.org/wikipedia/commons/thumb/0/0e/Felis_silvestris_silvestris.jpg/1200px-Felis_silvestris_silvestris.jpg"
          redirectUrl = "https://upload.wikimedia.org/wikipedia/commons/thumb/0/0e/Felis_silvestris_silvestris.jpg/1200px-Felis_silvestris_silvestris.jpg"
          intentPayload = "123123123"
        }
      }
    }
  }
}
